<div class="absolute inset-0 flex flex-col min-w-0 overflow-hidden">
    <!-- Header -->
    <div class="board-header">
        <div class="header-content">
            <div class="title-section">
                <h2 class="board-title">{{board?.title}}</h2>
            </div>
            <div class="actions-section">
                <button
                    mat-flat-button
                    [color]="'primary'"
                    (click)="createNewService()"
                    class="ml-4">
                    <mat-icon [svgIcon]="'heroicons_outline:plus'"></mat-icon>
                    <span class="ml-2">Nuevo Servicio</span>
                </button>
                <!-- Selector de técnico -->
                <mat-form-field class="tecnico-select">
                    <mat-label>Técnico asignado</mat-label>
                    <mat-select 
                        [(ngModel)]="selectedTecnicoId"
                        (selectionChange)="onTecnicoFilterChange($event.value)">
                        <mat-option [value]="'TODOS'">TODOS</mat-option>
                        <mat-option *ngFor="let tecnico of tecnicos" [value]="tecnico.id">
                            {{ tecnico.nombre }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
        </div>
    </div>

    <!-- Board -->
    <div class="board-container">
        <div class="lists-container">
            <!-- Lists -->
            <div *ngFor="let list of lists" 
                 [id]="list.id" 
                 class="list-wrapper"
                 [class.hidden]="isListHidden(list.id)">
                
                <!-- List header -->
                <div class="list-header">
                    <div class="list-title">
                        <span class="title">{{list.title}}</span>
                    </div>
                    
                    <div class="list-header-actions">
                        <span class="counter">{{listStates[list.id].total || 0}}</span>
                        <button mat-icon-button [matMenuTriggerFor]="listMenu" class="list-menu">
                            <mat-icon>more_vert</mat-icon>
                        </button>
                        <mat-menu #listMenu="matMenu">
                            <button mat-menu-item (click)="hideList(list.id)">
                                <mat-icon>visibility_off</mat-icon>
                                <span>Ocultar lista</span>
                            </button>
                        </mat-menu>
                    </div>
                </div>
                
                <!-- List content -->
                <div class="list-cards" 
                     cdkDropList 
                     [id]="list.id"
                     [cdkDropListData]="list.cards"
                     (cdkDropListDropped)="cardDropped($event)"
                     [cdkDropListConnectedTo]="getConnectedLists()">
                    
                    <scrumboard-card *ngFor="let card of list.cards"
                        [card]="card"
                        cdkDrag
                        [cdkDragData]="card">
                    </scrumboard-card>

                    <!-- Paginación -->
                    <div *ngIf="listStates[list.id].total > listStates[list.id].limit" 
                         class="pagination-controls">
                        <div class="pagination-info">
                            <div class="items-info">
                                {{getStartIndex(list.id)}} - {{getEndIndex(list.id)}} de {{listStates[list.id].total}} 
                            
                               - Página {{listStates[list.id].page}} de {{getTotalPages(list.id)}}
                            </div>
                        </div>
                        <div class="pagination-buttons">
                            <button mat-icon-button 
                                    [disabled]="listStates[list.id].page === 1"
                                    (click)="goToPage(list.id, 1)"
                                    matTooltip="Primera página">
                                <mat-icon>first_page</mat-icon>
                            </button>
                            <button mat-icon-button 
                                    [disabled]="listStates[list.id].page === 1"
                                    (click)="goToPage(list.id, listStates[list.id].page - 1)"
                                    matTooltip="Página anterior">
                                <mat-icon>chevron_left</mat-icon>
                            </button>
                            <button mat-icon-button 
                                    [disabled]="listStates[list.id].page >= getTotalPages(list.id)"
                                    (click)="goToPage(list.id, listStates[list.id].page + 1)"
                                    matTooltip="Página siguiente">
                                <mat-icon>chevron_right</mat-icon>
                            </button>
                            <button mat-icon-button 
                                    [disabled]="listStates[list.id].page >= getTotalPages(list.id)"
                                    (click)="goToPage(list.id, getTotalPages(list.id))"
                                    matTooltip="Última página">
                                <mat-icon>last_page</mat-icon>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Hidden Lists Menu -->
            <div *ngIf="hiddenLists.length > 0"
                 class="hidden-lists-menu">
                <div class="title">Listas Ocultas</div>
                <div *ngFor="let listId of hiddenLists">
                    <button mat-button 
                            class="hidden-list-item"
                            (click)="showList(listId)">
                        <mat-icon class="mr-2">visibility</mat-icon>
                        <span>Mostrar {{ getListTitle(listId) }}</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
